<!doctype html>
<html data-theme="nord">

<head>
    <title>Patient Diagnosis</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./output.css" rel="stylesheet">
    <script src="bundle.js"></script>
</head>
<script>
    async function handleSubmit() {
        const swapElement = document.querySelector('.swap');
        // Toggle to loading animation
        swapElement.classList.toggle('swap-active');

        // Get all text areas
        const textAreas = document.querySelectorAll('textarea');
        let prompts = [];
        textAreas.forEach(textArea => {
            prompts.push(textArea.value);
        });

        //let result = await window.sendToOpenAi([document.querySelector('#history').value]);
        let result = await window.sendToOpenAi([prompts]);
        const resultDisplayElement = document.querySelector('.swap-on');
        resultDisplayElement.innerHTML = result;

        // Toggle to result string
        swapElement.classList.toggle('swap-active');
    }
</script>

<body>
    <div class="flex w-full">
        <div class="grid p-8 w-1/2">
            <form>
                <h1 class="text-xl p-4">Patient information</h1>
                <div class="form-control p-4">
                    <textarea type="text" id="main-reason" class="textarea textarea-bordered w-full rounded" placeholder="Main reason for visit"></textarea>
                </div>
                <div class="form-control p-4">
                    <textarea type="text" id="description" class="textarea textarea-bordered w-full rounded" placeholder="Description of symptoms"></textarea>
                </div>
                <div class="form-control p-4">
                    <textarea type="text" id="duration" class="textarea textarea-bordered w-full rounded" placeholder="Duration of symptoms"></textarea>
                </div>
                <div class="form-control p-4">
                    <textarea type="text" id="treatments" class="textarea textarea-bordered w-full rounded" placeholder="Current treatments"></textarea>
                </div>
                <div class="form-control p-4">
                    <textarea type="text" id="history" class="textarea textarea-bordered w-full rounded" placeholder="Patient history"></textarea>
                </div>
                <button type="button" class="btn btn-accent m-4" onclick="handleSubmit()">Submit</button>
            </form>
        </div>
        <div class="divider divider-horizontal"></div>
        <div class="grid p-8 w-1/2 place-items-center">
            <div class="card-bordered bg-base-300 w-full shadow-xl border-secondary rounded-lg">
                <div class="card-body">
                    <h2 class="card-title pb-4 text-neutral">OpenAI Response</h2>
                    <label class="swap swap-active justify-start select-auto">
                        <div class="swap-on prose">
                            <p class="italic justify-start text-neutral">Waiting for input...</p>
                        </div>
                        <div class="swap-off">
                            <span class="loading loading-dots loading-lg"></span>
                        </div>
                    </label>
                </div>
            </div>
        </div>
    </div>
</body>

</html>